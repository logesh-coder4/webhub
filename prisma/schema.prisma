generator client {
  provider = "prisma-client"
  output   = "../lib/generated/prisma"
}

datasource db {
  provider = "mysql"
}

model User {
  id                Int                @id @default(autoincrement())
  username          String
  email             String             @unique
  password          String
  joinedAt          DateTime           @default(now())
  isSuperUser       Boolean            @default(false)
  isActive          Boolean            @default(false)
  isAdmin           Boolean            @default(false)
  resetToken        String?
  resetTokenExpires DateTime?
  profession        UserProfession     @default(other)
  Blogs             Blog[]
  message           Message[]
  notifications     Notification[]
  otherProjects     OtherProjects[]
  testimonials      Testimonials[]
  token             VerificationToken?
  webProjects       WebProjects[]
}

model VerificationToken {
  id        String   @id @default(uuid())
  token     String   @unique
  userId    Int      @unique
  expiresAt DateTime
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model Testimonials {
  id         Int      @id @default(autoincrement())
  message    String   @db.Text
  userId     Int
  ratings    String   @default("0")
  isApproved Boolean  @default(false)
  createdAt  DateTime @default(now())
  user       User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "Testimonials_userId_fkey")
}

model WebProjects {
  id           Int           @id @default(autoincrement())
  model        String        @default("web")
  name         String
  description  String        @db.Text
  userId       Int
  projectType  ProjectType   @default(Others)
  frontendTech FrontendTech?
  backendTech  BackendTech?
  database     Database?
  language     Language?
  service      WebServices?
  createdAt    DateTime      @default(now())
  isVerified   Boolean       @default(false)
  price        Float         @default(0)
  status       ProjectStatus @default(upcoming)
  timeTaken    Int           @default(0)
  secreatKey   String?       @unique
  messages     Message[]     @relation("WebProjects")
  user         User          @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "WebProjects_userId_fkey")
}

model OtherProjects {
  id          Int            @id @default(autoincrement())
  technology  String?
  domain      Domain?
  projectName String?
  model       String         @default("others")
  projectType ProjectType?   @default(Others)
  TaskType    String?
  service     OtherServices?
  description String?        @db.Text
  createdAt   DateTime       @default(now())
  isVerified  Boolean        @default(false)
  userId      Int
  price       Float          @default(0)
  timeTaken   Int            @default(0)
  secreatKey  String?        @unique
  progress    Float          @default(0)
  messages    Message[]      @relation("OtherProjects")
  user        User           @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "OtherProjects_userId_fkey")
}

model Blog {
  id          Int      @id @default(autoincrement())
  title       String?
  description String   @db.Text
  isPublished Boolean  @default(false)
  userId      Int
  createdAt   DateTime @default(now())
  user        User     @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "Blog_userId_fkey")
}

model Message {
  id              Int            @id @default(autoincrement())
  text            String
  senderId        Int
  webProjectKey   String?
  otherProjectKey String?
  createdAt       DateTime       @default(now())
  otherProject    OtherProjects? @relation("OtherProjects", fields: [otherProjectKey], references: [secreatKey])
  sender          User           @relation(fields: [senderId], references: [id], onDelete: Cascade)
  webProject      WebProjects?   @relation("WebProjects", fields: [webProjectKey], references: [secreatKey])

  @@index([otherProjectKey], map: "Message_otherProjectKey_fkey")
  @@index([senderId], map: "Message_senderId_fkey")
  @@index([webProjectKey], map: "Message_webProjectKey_fkey")
}

model Notification {
  id        Int               @id @default(autoincrement())
  title     String?
  message   String
  userId    Int
  isRead    Boolean           @default(false)
  type      NotificationType?
  createdAt DateTime          @default(now())
  user      User              @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId], map: "Notification_userId_fkey")
}

enum FrontendTech {
  Random
  HTML
  React
  NextJs
}

enum BackendTech {
  Random
  Django
  FastApi
  Flask
  Express
  NextJs
}

enum Database {
  Random
  MySql
  Postgress
  MongoDB
}

enum Language {
  Python
  JavaScript
  TypeScript
}

enum ProjectType {
  Ecommerce
  Portfolio
  OTT
  Others
}

enum Domain {
  Frontend
  Backend
  FullStack
  Other
}

enum WebServices {
  frontend
  backend
  fullstack
  mobileapp
  utils
  api
  testcase
}

enum OtherServices {
  mentorship
  learner
  supporter
  worker
  collab
}

enum ProjectStatus {
  upcoming
  ongoing
  completed
}

enum NotificationType {
  request
  update
  change
}

enum UserProfession {
  student
  developer
  freelancer
  entrapaneour
  other
}
